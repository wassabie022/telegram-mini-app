"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});class i extends Error{constructor(e,r,a){super(typeof r=="object"?r.message:r||e,{cause:typeof r=="object"?r.cause:a}),this.type=e,Object.setPrototypeOf(this,i.prototype)}}function E(t){return t.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`)}function L(t){return t.replace(/_[a-z]/g,e=>e[1].toUpperCase())}const P="ERR_INVALID_VALUE",R="ERR_UNEXPECTED_VALUE",A="ERR_UNEXPECTED_TYPE",b="ERR_PARSE";function S(t,e){const r={};for(const a in t){const n=t[a];if(!n)continue;let o,u;typeof n=="function"?(o=a,u=n):[o,u]=n;try{const p=u(e(o));p!==void 0&&(r[a]=p)}catch(p){throw new i(b,`Parser for "${a}" property failed${o===a?"":`. Source field: "${o}"`}`,p)}}return r}function h(t){let e=t;if(typeof e=="string")try{e=JSON.parse(e)}catch(r){throw new i(P,{cause:r})}if(typeof e!="object"||!e||Array.isArray(e))throw new i(R);return e}function s(t,e){return r=>{const a=n=>{if(!(r&&n===void 0))try{return e(n)}catch(o){throw new i(b,{message:`"${t}" transformer failed to parse the value`,cause:o})}};return Object.assign(a,{isValid(n){try{return a(n),!0}catch{return!1}}})}}function m(t,e){return s(e||"object",r=>{const a=h(r);return S(t,n=>a[n])})}function f(t){throw new i(A,`Unexpected value received: ${JSON.stringify(t)}`)}const y=s("boolean",t=>{if(typeof t=="boolean")return t;const e=String(t);if(e==="1"||e==="true")return!0;if(e==="0"||e==="false")return!1;f(t)}),c=s("string",t=>{if(typeof t=="string"||typeof t=="number")return t.toString();f(t)}),l=s("number",t=>{if(typeof t=="number")return t;if(typeof t=="string"){const e=Number(t);if(!Number.isNaN(e))return e}f(t)}),w=s("date",t=>t instanceof Date?t:new Date(l()(t)*1e3));function d(t,e){return s(e||"searchParams",r=>{typeof r!="string"&&!(r instanceof URLSearchParams)&&f(r);const a=typeof r=="string"?new URLSearchParams(r):r;return S(t,n=>{const o=a.get(n);return o===null?void 0:o})})}function g(t){for(const e in t)t[e]=[E(e),t[e]];return t}const D=t=>{const e=l(),r=l(!0),a=c(),n=c(!0),o=y(!0),u=m(g({addedToAttachmentMenu:o,allowsWriteToPm:o,firstName:a,id:e,isBot:o,isPremium:o,languageCode:n,lastName:n,photoUrl:n,username:n}),"User")(!0);return d(g({authDate:w(),canSendAfter:r,chat:m(g({id:e,type:a,title:a,photoUrl:n,username:n}),"Chat")(!0),chatInstance:n,chatType:n,hash:a,queryId:n,receiver:u,startParam:n,user:u}),"initData")(t)};function _(t){return/^#[\da-f]{6}$/i.test(t)}function U(t){return/^#[\da-f]{3}$/i.test(t)}function T(t){const e=t.replace(/\s/g,"").toLowerCase();if(_(e))return e;if(U(e)){let a="#";for(let n=0;n<3;n+=1)a+=e[1+n].repeat(2);return a}const r=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!r)throw new Error(`Value "${t}" does not satisfy any of known RGB formats.`);return r.slice(1).reduce((a,n)=>{const o=parseInt(n,10).toString(16);return a+(o.length===1?"0":"")+o},"#")}const N=s("rgb",t=>T(c()(t))),O=s("themeParams",t=>{const e=N(!0);return Object.entries(h(t)).reduce((r,[a,n])=>(r[L(a)]=e(n),r),{})});function V(t){return JSON.stringify(Object.fromEntries(Object.entries(t).map(([e,r])=>[E(e),r])))}const W=t=>{const e=c(),r=c(!0),a=y(!0);return d({botInline:["tgWebAppBotInline",a],initData:["tgWebAppData",D(!0)],initDataRaw:["tgWebAppData",r],platform:["tgWebAppPlatform",e],showSettings:["tgWebAppShowSettings",a],startParam:["tgWebAppStartParam",r],themeParams:["tgWebAppThemeParams",O()],version:["tgWebAppVersion",e]},"launchParams")(t)};function j(t){const{initDataRaw:e,startParam:r,showSettings:a,botInline:n}=t,o=new URLSearchParams;return o.set("tgWebAppPlatform",t.platform),o.set("tgWebAppThemeParams",V(t.themeParams)),o.set("tgWebAppVersion",t.version),e&&o.set("tgWebAppData",e),r&&o.set("tgWebAppStartParam",r),typeof a=="boolean"&&o.set("tgWebAppShowSettings",a?"1":"0"),typeof n=="boolean"&&o.set("tgWebAppBotInline",n?"1":"0"),o.toString()}const $=m({eventType:c(),eventData:t=>t},"miniAppsMessage");function I(t,e){return s(e||"array",r=>{let a;if(Array.isArray(r))a=r;else if(typeof r=="string")try{const n=JSON.parse(r);Array.isArray(n)&&(a=n)}catch{}return a||f(r),a.map(t)})}const C=s("fn",t=>{if(typeof t=="function")return t;f(t)});function B(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}exports.ERR_INVALID_VALUE=P;exports.ERR_PARSE=b;exports.ERR_UNEXPECTED_TYPE=A;exports.ERR_UNEXPECTED_VALUE=R;exports.array=I;exports.boolean=y;exports.createTransformerGen=s;exports.date=w;exports.fn=C;exports.initData=D;exports.isRGB=_;exports.isRGBShort=U;exports.isRecord=B;exports.launchParams=W;exports.miniAppsMessage=$;exports.number=l;exports.object=m;exports.rgb=N;exports.searchParams=d;exports.serializeLaunchParams=j;exports.serializeThemeParams=V;exports.string=c;exports.themeParams=O;exports.toRGB=T;exports.toRecord=h;
//# sourceMappingURL=index.cjs.map
