{"version":3,"file":"index.cjs","sources":["../../toolkit/dist/index.js","../src/errors/errors.ts","../src/parseBySchema.ts","../src/toRecord.ts","../src/transformers/createTransformerGen.ts","../src/transformers/object.ts","../src/errors/throwUnexpectedValue.ts","../src/transformers/boolean.ts","../src/transformers/string.ts","../src/transformers/number.ts","../src/transformers/date.ts","../src/transformers/searchParams.ts","../src/complex/initData.ts","../src/validators/isRGB.ts","../src/validators/isRGBShort.ts","../src/toRGB.ts","../src/transformers/rgb.ts","../src/complex/theme-params.ts","../src/complex/launch-params.ts","../src/complex/miniAppsMessage.ts","../src/transformers/array.ts","../src/transformers/fn.ts","../src/validators/isRecord.ts"],"sourcesContent":["var k = Object.defineProperty;\nvar I = (r, e, t) => e in r ? k(r, e, { enumerable: !0, configurable: !0, writable: !0, value: t }) : r[e] = t;\nvar E = (r, e, t) => I(r, typeof e != \"symbol\" ? e + \"\" : e, t);\nclass d extends Error {\n  constructor(e, t, n) {\n    super(\n      typeof t == \"object\" ? t.message : t || e,\n      {\n        cause: typeof t == \"object\" ? t.cause : n\n      }\n    ), this.type = e, Object.setPrototypeOf(this, d.prototype);\n  }\n}\nfunction x(r, e, t) {\n  return r.addEventListener(e, t), () => r.removeEventListener(e, t);\n}\nfunction _(...r) {\n  const e = r.flat(1);\n  return [\n    e.push.bind(e),\n    () => {\n      e.forEach((t) => {\n        t();\n      });\n    }\n  ];\n}\nfunction F(r, e) {\n  return r instanceof d && r.type === e;\n}\nfunction m(r) {\n  return (e) => F(e, r);\n}\nconst R = \"ERR_ABORTED\", $ = \"ERR_CANCELED\", S = \"ERR_TIMED_OUT\";\nfunction C(r) {\n  return new d(R, { cause: r });\n}\nconst U = m(S), V = m(R), B = m($);\nfunction T(r, e) {\n  return r.reject = e.reject, r;\n}\nclass i extends Promise {\n  constructor(t, n) {\n    let o, s;\n    typeof t == \"function\" ? (o = t, s = n) : s = t;\n    let u, c;\n    super((a, h) => {\n      s || (s = {});\n      const { abortSignal: l } = s;\n      if (l && l.aborted)\n        return h(C(l.reason));\n      const [y, A] = _(), b = (f) => (...L) => (A(), f(...L)), w = new AbortController(), { signal: D } = w;\n      c = b((f) => {\n        w.abort(f), h(f);\n      }), u = b(a), l && y(\n        x(l, \"abort\", () => {\n          c(C(l.reason));\n        })\n      );\n      const { timeout: g } = s;\n      if (g) {\n        const f = setTimeout(() => {\n          c(new d(S, `Timeout reached: ${g}ms`));\n        }, g);\n        y(() => {\n          clearTimeout(f);\n        });\n      }\n      o && o(u, c, D);\n    });\n    /**\n     * Rejects the promise.\n     */\n    E(this, \"reject\");\n    this.reject = c;\n  }\n  /**\n   * Creates a new BetterPromise instance using executor, resolving promise when a result\n   * was returned.\n   * @param fn - function returning promise result.\n   * @param options - additional options.\n   */\n  static withFn(t, n) {\n    return new i((o, s, u) => {\n      try {\n        const c = t(u);\n        return c instanceof Promise ? c.then(o, s) : o(c);\n      } catch (c) {\n        s(c);\n      }\n    }, n);\n  }\n  /**\n   * @see Promise.resolve\n   */\n  static resolve(t) {\n    return new i((n) => {\n      n(t);\n    });\n  }\n  /**\n   * @see Promise.reject\n   */\n  static reject(t) {\n    return new i((n, o) => {\n      o(t);\n    });\n  }\n  /**\n   * Cancels the promise execution.\n   */\n  cancel() {\n    this.reject(new d($));\n  }\n  /**\n   * @see Promise.catch\n   */\n  catch(t) {\n    return this.then(void 0, t);\n  }\n  /**\n   * @see Promise.finally\n   */\n  finally(t) {\n    return T(super.finally(t), this);\n  }\n  /**\n   * @see Promise.then\n   */\n  then(t, n) {\n    return T(super.then(t, n), this);\n  }\n}\nfunction v(r, e) {\n  return r.resolve = e.resolve, r;\n}\nclass p extends i {\n  constructor(t, n) {\n    let o, s;\n    typeof t == \"function\" ? (o = t, s = n) : s = t;\n    let u;\n    super((c, a, h) => {\n      u = c, o && o(c, a, h);\n    }, s);\n    /**\n     * Resolves the promise.\n     */\n    E(this, \"resolve\");\n    this.resolve = u;\n  }\n  /**\n   * Creates a new EnhancedPromise instance using executor, resolving promise when a result\n   * was returned.\n   * @param fn - function returning promise result.\n   * @param options - additional options.\n   */\n  static withFn(t, n) {\n    return new p(\n      (o, s, u) => i.withFn(t, { abortSignal: u }).then(o, s),\n      n\n    );\n  }\n  /**\n   * @see Promise.resolve\n   */\n  static resolve(t) {\n    return new p((n) => {\n      n(t);\n    });\n  }\n  /**\n   * @see Promise.reject\n   */\n  static reject(t) {\n    return new p((n, o) => {\n      o(t);\n    });\n  }\n  /**\n   * @see Promise.catch\n   */\n  catch(t) {\n    return this.then(void 0, t);\n  }\n  /**\n   * @see Promise.finally\n   */\n  finally(t) {\n    return v(super.finally(t), this);\n  }\n  /**\n   * @see Promise.then\n   */\n  then(t, n) {\n    return v(super.then(t, n), this);\n  }\n}\nfunction Z(r, e) {\n  return new i((t) => {\n    setTimeout(t, r);\n  }, { abortSignal: e });\n}\nfunction j(r) {\n  return `tapps/${r}`;\n}\nfunction J(r, e) {\n  sessionStorage.setItem(j(r), JSON.stringify(e));\n}\nfunction K(r) {\n  const e = sessionStorage.getItem(j(r));\n  try {\n    return e ? JSON.parse(e) : void 0;\n  } catch {\n  }\n}\nfunction M(r) {\n  return r.replace(/[A-Z]/g, (e) => `-${e.toLowerCase()}`);\n}\nfunction z(r) {\n  return r.replace(/[A-Z]/g, (e) => `_${e.toLowerCase()}`);\n}\nfunction G(r) {\n  return r.replace(/_[a-z]/g, (e) => e[1].toUpperCase());\n}\n// @__NO_SIDE_EFFECTS__\nfunction q(r, e) {\n  e || (e = {});\n  const {\n    textColor: t,\n    bgColor: n,\n    shouldLog: o = !0\n  } = e;\n  function s(u, ...c) {\n    if (!o || typeof o == \"function\" && !o())\n      return;\n    const a = \"font-weight:bold;padding:0 5px;border-radius:5px\";\n    console[u](\n      `%c${Intl.DateTimeFormat(\"en-GB\", {\n        hour: \"2-digit\",\n        minute: \"2-digit\",\n        second: \"2-digit\",\n        fractionalSecondDigits: 3,\n        timeZone: \"UTC\"\n      }).format(/* @__PURE__ */ new Date())}%c / %c${r}`,\n      `${a};background-color: lightblue;color:black`,\n      \"\",\n      `${a};${t ? `color:${t};` : \"\"}${n ? `background-color:${n}` : \"\"}`,\n      ...c\n    );\n  }\n  return [\n    function(...c) {\n      s(\"log\", ...c);\n    },\n    function(...c) {\n      s(\"error\", ...c);\n    }\n  ];\n}\nfunction H(r, e) {\n  document.documentElement.style.setProperty(r, e);\n}\nfunction P(r) {\n  document.documentElement.style.removeProperty(r);\n}\nexport {\n  i as CancelablePromise,\n  R as ERR_ABORTED,\n  $ as ERR_CANCELED,\n  S as ERR_TIMED_OUT,\n  p as EnhancedPromise,\n  d as TypedError,\n  x as addEventListener,\n  M as camelToKebab,\n  z as camelToSnake,\n  C as createAbortError,\n  _ as createCbCollector,\n  q as createLogger,\n  m as createTypedErrorPredicate,\n  P as deleteCssVar,\n  K as getStorageValue,\n  V as isAbortError,\n  B as isCanceledError,\n  F as isErrorOfType,\n  U as isTimeoutError,\n  H as setCssVar,\n  J as setStorageValue,\n  Z as sleep,\n  G as snakeToCamel\n};\n//# sourceMappingURL=index.js.map\n","export const ERR_INVALID_VALUE = 'ERR_INVALID_VALUE';\nexport const ERR_UNEXPECTED_VALUE = 'ERR_UNEXPECTED_VALUE';\nexport const ERR_UNEXPECTED_TYPE = 'ERR_UNEXPECTED_TYPE';\nexport const ERR_PARSE = 'ERR_PARSE';\n","import { TypedError } from '@telegram-apps/toolkit';\n\nimport { ERR_PARSE } from './errors/errors.js';\nimport type { TransformFn, Schema } from './types.js';\n\n/**\n * Parses external value by specified schema. Functions iterates over each schema field\n * and uses getField function to get its value from the external source.\n * @param schema - object schema.\n * @param getField - function which gets external value by its field name.\n */\nexport function parseBySchema<T>(\n  schema: Schema<T>,\n  getField: (field: string) => unknown,\n): T {\n  const result = {} as T;\n\n  for (const field in schema) {\n    const definition = schema[field];\n    if (!definition) {\n      continue;\n    }\n\n    let from: string;\n    let transform: TransformFn<any>;\n\n    if (typeof definition === 'function') {\n      from = field;\n      transform = definition;\n    } else {\n      [from, transform] = definition;\n    }\n\n    try {\n      const parsedValue = transform(getField(from));\n      if (parsedValue !== undefined) {\n        (result as any)[field] = parsedValue;\n      }\n    } catch (cause) {\n      throw new TypedError(\n        ERR_PARSE,\n        `Parser for \"${field}\" property failed${from === field ? '' : `. Source field: \"${from}\"`}`,\n        cause\n      );\n    }\n  }\n\n  return result;\n}\n","import { TypedError } from '@telegram-apps/toolkit';\n\nimport { ERR_INVALID_VALUE, ERR_UNEXPECTED_VALUE } from '@/errors/errors.js';\n\n/**\n * Converts value to a record.\n * @param value - value to convert.\n * @throws {TypedError} ERR_INVALID_VALUE\n * @throws {TypedError} ERR_UNEXPECTED_VALUE\n */\nexport function toRecord(value: unknown): Record<string, unknown> {\n  let formattedValue: any = value;\n\n  // Convert value to JSON in case, it is string. We expect value to be JSON string.\n  if (typeof formattedValue === 'string') {\n    try {\n      formattedValue = JSON.parse(formattedValue);\n    } catch (cause) {\n      throw new TypedError(ERR_INVALID_VALUE, { cause });\n    }\n  }\n\n  // We expect json to be a usual object.\n  if (\n    typeof formattedValue !== 'object'\n    || !formattedValue\n    || Array.isArray(formattedValue)\n  ) {\n    throw new TypedError(ERR_UNEXPECTED_VALUE);\n  }\n\n  return formattedValue as Record<string, unknown>;\n}\n","import {TypedError} from '@telegram-apps/toolkit';\n\nimport { ERR_PARSE } from '@/errors/errors.js';\nimport type { Transformer, TransformerGen, TransformFn } from '@/types.js';\n\n/**\n * Creates transformer generator using the passed transform function as a base.\n * @param transform - transform function.\n * @param name - custom transformer name.\n */\nexport function createTransformerGen<T>(\n  name: string,\n  transform: TransformFn<T>\n): TransformerGen<T> {\n  return (optional?) => {\n    const parse = ((value: unknown) => {\n      if (optional && value === undefined) {\n        return;\n      }\n\n      try {\n        return transform(value);\n      } catch (cause) {\n        throw new TypedError(ERR_PARSE, {\n          message: `\"${name}\" transformer failed to parse the value`,\n          cause,\n        });\n      }\n    }) as TransformFn<T>;\n\n    return /* #__PURE__ */ Object.assign(\n      parse,\n      {\n        isValid(value: unknown): value is T {\n          try {\n            parse(value);\n            return true;\n          } catch {\n            return false;\n          }\n        }\n      }\n    ) satisfies Transformer<T>\n  };\n}\n","import { parseBySchema } from '@/parseBySchema.js';\nimport { toRecord } from '@/toRecord.js';\nimport type { TransformerGen, Schema } from '@/types.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\n\nexport function object<T>(schema: Schema<T>, name?: string): TransformerGen<T> {\n  return createTransformerGen(name || 'object', v => {\n    const record = toRecord(v);\n    return parseBySchema(schema, f => record[f]);\n  });\n}\n","import { TypedError } from '@telegram-apps/toolkit';\n\nimport { ERR_UNEXPECTED_TYPE } from './errors.js';\n\nexport function throwUnexpectedValue(value: unknown): never {\n  throw new TypedError(ERR_UNEXPECTED_TYPE, `Unexpected value received: ${JSON.stringify(value)}`);\n}","import { throwUnexpectedValue } from '@/errors/throwUnexpectedValue.js';\nimport type { TransformerGen } from '@/types.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\n\nexport const boolean: TransformerGen<boolean> = createTransformerGen('boolean', v => {\n  if (typeof v === 'boolean') {\n    return v;\n  }\n  const str = String(v);\n  if (str === '1' || str === 'true') {\n    return true;\n  }\n  if (str === '0' || str === 'false') {\n    return false;\n  }\n  throwUnexpectedValue(v);\n});\n","import { throwUnexpectedValue } from '@/errors/throwUnexpectedValue.js';\nimport type { TransformerGen } from '@/types.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\n\nexport const string: TransformerGen<string> = createTransformerGen('string', v => {\n  if (typeof v === 'string' || typeof v === 'number') {\n    return v.toString();\n  }\n  throwUnexpectedValue(v);\n});\n","import { throwUnexpectedValue } from '@/errors/throwUnexpectedValue.js';\nimport type { TransformerGen } from '@/types.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\n\nexport const number: TransformerGen<number> = createTransformerGen('number', v => {\n  if (typeof v === 'number') {\n    return v;\n  }\n  if (typeof v === 'string') {\n    const num = Number(v);\n    if (!Number.isNaN(num)) {\n      return num;\n    }\n  }\n  throwUnexpectedValue(v);\n});\n","import type { TransformerGen } from '@/types.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\nimport { number } from './number.js';\n\nexport const date: TransformerGen<Date> = createTransformerGen('date', v => (\n  v instanceof Date ? v : new Date(number()(v) * 1000)\n));\n","import { throwUnexpectedValue } from '@/errors/throwUnexpectedValue.js';\nimport { parseBySchema } from '@/parseBySchema.js';\nimport type { Schema, TransformerGen } from '@/types.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\n\nexport function searchParams<T>(schema: Schema<T>, name?: string): TransformerGen<T> {\n  return createTransformerGen(name || 'searchParams', v => {\n    if (typeof v !== 'string' && !(v instanceof URLSearchParams)) {\n      throwUnexpectedValue(v);\n    }\n\n    const params = typeof v === 'string' ? new URLSearchParams(v) : v;\n\n    return parseBySchema(schema, (field) => {\n      const paramValue = params.get(field);\n      return paramValue === null ? undefined : paramValue;\n    });\n  });\n}\n","import { camelToSnake } from '@telegram-apps/toolkit';\nimport type { Chat, InitData, User } from '@telegram-apps/types';\n\nimport type { Schema, TransformerGen, TransformFn } from '@/types.js';\n\nimport { object } from '@/transformers/object.js';\nimport { boolean as createBoolean } from '@/transformers/boolean.js';\nimport { string as createString } from '@/transformers/string.js';\nimport { number as createNumber } from '@/transformers/number.js';\nimport { date } from '@/transformers/date.js';\nimport { searchParams } from '@/transformers/searchParams.js';\n\nfunction toSnakeCaseSource<T>(schema: { [K in keyof T]: TransformFn<T[K]> }): Schema<T> {\n  for (const key in schema) {\n    (schema as any)[key] = [camelToSnake(key), schema[key]];\n  }\n  return schema;\n}\n\nexport const initData: TransformerGen<InitData> = (optional) => {\n  const number = createNumber();\n  const numberOptional = createNumber(true);\n  const string = createString();\n  const stringOptional = createString(true);\n  const boolOptional = createBoolean(true);\n\n  const user = object<User>(toSnakeCaseSource({\n    addedToAttachmentMenu: boolOptional,\n    allowsWriteToPm: boolOptional,\n    firstName: string,\n    id: number,\n    isBot: boolOptional,\n    isPremium: boolOptional,\n    languageCode: stringOptional,\n    lastName: stringOptional,\n    photoUrl: stringOptional,\n    username: stringOptional,\n  }), 'User')(true);\n\n  return searchParams<InitData>(\n    toSnakeCaseSource({\n      authDate: date(),\n      canSendAfter: numberOptional,\n      chat: object<Chat>(\n        toSnakeCaseSource({\n          id: number,\n          type: string,\n          title: string,\n          photoUrl: stringOptional,\n          username: stringOptional,\n        }),\n        'Chat',\n      )(true),\n      chatInstance: stringOptional,\n      chatType: stringOptional,\n      hash: string,\n      queryId: stringOptional,\n      receiver: user,\n      startParam: stringOptional,\n      user,\n    }),\n    'initData',\n  )(optional);\n}\n\nexport type { InitData };\n","import type { RGB } from '@telegram-apps/types';\n\n/**\n * Returns true in case, passed value has #RRGGBB format.\n * @param value - value to check.\n */\nexport function isRGB(value: string): value is RGB {\n  return /^#[\\da-f]{6}$/i.test(value);\n}\n","import type { RGBShort } from '@telegram-apps/types';\n\n/**\n * Returns true in case, passed value has #RGB format.\n * @param value - value to check.\n */\nexport function isRGBShort(value: string): value is RGBShort {\n  return /^#[\\da-f]{3}$/i.test(value);\n}\n","import type { RGB } from '@telegram-apps/types';\n\nimport { isRGB } from './validators/isRGB.js';\nimport { isRGBShort } from './validators/isRGBShort.js';\n\n/**\n * Converts passed value to #RRGGBB format. Accepts following color formats:\n * - `#RGB`\n * - `#RRGGBB`\n * - `rgb(1,2,3)`\n * - `rgba(1,2,3,4)`\n * @param value - value to convert.\n * @throws {Error} Passed value does not satisfy any of known RGB formats.\n */\nexport function toRGB(value: string): RGB {\n  // Remove all spaces.\n  const clean = value.replace(/\\s/g, '').toLowerCase();\n\n  // Value already has required format.\n  if (isRGB(clean)) {\n    return clean;\n  }\n\n  // Convert from #RGB.\n  if (isRGBShort(clean)) {\n    let color: RGB = '#';\n    for (let i = 0; i < 3; i += 1) {\n      color += clean[1 + i].repeat(2);\n    }\n    return color;\n  }\n\n  // Example valid values: rgb(0,3,10) rgba(32,114,8,0)\n  const match = clean.match(/^rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)$/)\n    || clean.match(/^rgba\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3}),\\d{1,3}\\)$/);\n\n  // In case, this didn't work as well, we can't extract RGB color from passed\n  // text.\n  if (!match) {\n    throw new Error(`Value \"${value}\" does not satisfy any of known RGB formats.`);\n  }\n\n  // Otherwise, take R, G and B components, convert to hex and create #RRGGBB\n  // string.\n  return match.slice(1).reduce((acc, component) => {\n    const formatted = parseInt(component, 10).toString(16);\n    return acc + (formatted.length === 1 ? '0' : '') + formatted;\n  }, '#') as RGB;\n}\n","import type { RGB } from '@telegram-apps/types';\n\nimport { toRGB } from '@/toRGB.js';\nimport type { TransformerGen } from '@/types.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\n\nimport { string } from './string.js';\n\nexport const rgb: TransformerGen<RGB> = createTransformerGen('rgb', v => toRGB(string()(v)));\n","import { camelToSnake, snakeToCamel } from '@telegram-apps/toolkit';\nimport type { ThemeParams } from '@telegram-apps/types';\n\nimport { toRecord } from '@/toRecord.js';\nimport { rgb } from '@/transformers/rgb.js';\nimport { createTransformerGen } from '@/transformers/createTransformerGen.js';\nimport type { TransformerGen } from '@/types.js';\n\nexport const themeParams: TransformerGen<ThemeParams> = createTransformerGen(\n  'themeParams',\n  value => {\n    const rgbOptional = rgb(true);\n\n    return Object\n      .entries(toRecord(value))\n      .reduce<ThemeParams>((acc, [k, v]) => {\n        acc[snakeToCamel(k)] = rgbOptional(v);\n        return acc;\n      }, {});\n  },\n);\n\n/**\n * Serializes theme parameters to representation sent from the Telegram application.\n */\n// #__NO_SIDE_EFFECTS__\nexport function serializeThemeParams(themeParams: ThemeParams): string {\n  return JSON.stringify(\n    Object.fromEntries(\n      Object\n        .entries(themeParams)\n        .map(([key, value]) => [camelToSnake(key), value]),\n    ),\n  );\n}\n\nexport type { ThemeParams };","import type { LaunchParams } from '@telegram-apps/types';\n\nimport { searchParams } from '@/transformers/searchParams.js';\nimport { boolean as createBoolean } from '@/transformers/boolean.js';\nimport { string as createString } from '@/transformers/string.js';\n\nimport { serializeThemeParams, themeParams } from './theme-params.js';\nimport { initData } from './initData.js';\nimport type { TransformerGen } from '@/types.js';\n\nexport const launchParams: TransformerGen<LaunchParams> = (optional) => {\n  const string = createString();\n  const stringOptional = createString(true);\n  const boolOptional = createBoolean(true);\n\n  return searchParams<LaunchParams>({\n    botInline: ['tgWebAppBotInline', boolOptional],\n    initData: ['tgWebAppData', initData(true)],\n    initDataRaw: ['tgWebAppData', stringOptional],\n    platform: ['tgWebAppPlatform', string],\n    showSettings: ['tgWebAppShowSettings', boolOptional],\n    startParam: ['tgWebAppStartParam', stringOptional],\n    themeParams: ['tgWebAppThemeParams', themeParams()],\n    version: ['tgWebAppVersion', string],\n  }, 'launchParams')(optional);\n};\n\n/**\n * Serializes launch parameters to representation sent from the Telegram application.\n */\n// #__NO_SIDE_EFFECTS__\nexport function serializeLaunchParams(lp: LaunchParams): string {\n  const { initDataRaw, startParam, showSettings, botInline } = lp;\n\n  const params = new URLSearchParams();\n\n  params.set('tgWebAppPlatform', lp.platform);\n  params.set('tgWebAppThemeParams', serializeThemeParams(lp.themeParams));\n  params.set('tgWebAppVersion', lp.version);\n  initDataRaw && params.set('tgWebAppData', initDataRaw);\n  startParam && params.set('tgWebAppStartParam', startParam);\n  typeof showSettings === 'boolean' && params.set('tgWebAppShowSettings', showSettings ? '1' : '0');\n  typeof botInline === 'boolean' && params.set('tgWebAppBotInline', botInline ? '1' : '0');\n\n  return params.toString();\n}\n\nexport type { LaunchParams };","import { object } from '@/transformers/object.js';\nimport { string } from '@/transformers/string.js';\n\nexport interface MiniAppsMessage {\n  eventType: string;\n  eventData?: unknown;\n}\n\nexport const miniAppsMessage = object<MiniAppsMessage>({\n  eventType: string(),\n  eventData: v => v,\n}, 'miniAppsMessage');\n","import { throwUnexpectedValue } from '@/errors/throwUnexpectedValue.js';\nimport type { TransformerGen, TransformFn } from '@/types.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\n\nexport function array<T>(of: TransformFn<T>, name?: string): TransformerGen<T[]> {\n  return createTransformerGen(name || 'array', v => {\n    let a: unknown[] | undefined;\n\n    if (Array.isArray(v)) {\n      a = v;\n    } else if (typeof v === 'string') {\n      try {\n        const json = JSON.parse(v);\n        if (Array.isArray(json)) {\n          a = json;\n        }\n      } catch {\n      }\n    }\n    if (!a) {\n      throwUnexpectedValue(v);\n    }\n    return a.map(of);\n  });\n}\n","import { throwUnexpectedValue } from '@/errors/throwUnexpectedValue.js';\n\nimport { createTransformerGen } from './createTransformerGen.js';\n\nexport const fn = createTransformerGen<(...args: unknown[]) => unknown>('fn', (v) => {\n  if (typeof v === 'function') {\n    return v as (...args: unknown[]) => unknown;\n  }\n  throwUnexpectedValue(v);\n});","/**\n * States that passed value is Record and not Array.\n * @param value - value to check.\n */\nexport function isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && typeof value === 'object' && !Array.isArray(value);\n}\n"],"names":["d","t","n","z","r","G","ERR_INVALID_VALUE","ERR_UNEXPECTED_VALUE","ERR_UNEXPECTED_TYPE","ERR_PARSE","parseBySchema","schema","getField","result","field","definition","from","transform","parsedValue","cause","TypedError","toRecord","value","formattedValue","createTransformerGen","name","optional","parse","object","v","record","f","throwUnexpectedValue","boolean","str","string","number","num","date","searchParams","params","paramValue","toSnakeCaseSource","key","camelToSnake","initData","createNumber","numberOptional","createString","stringOptional","boolOptional","createBoolean","user","isRGB","isRGBShort","toRGB","clean","color","i","match","acc","component","formatted","rgb","themeParams","rgbOptional","k","snakeToCamel","serializeThemeParams","launchParams","serializeLaunchParams","lp","initDataRaw","startParam","showSettings","botInline","miniAppsMessage","array","of","json","fn","isRecord"],"mappings":"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"}